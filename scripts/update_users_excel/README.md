# update_users_excel.py

This script fetches the users from the wiki database or from the CSV file generated by the [UserExport extension](https://github.com/PowerpediaInterns/mediawiki-extensions-UserExport), formats the data and inserts it into an Excel file, and then uploads the Excel file to the wiki.

## Requirements

* Database read access or [UserExport extension](https://github.com/PowerpediaInterns/mediawiki-extensions-UserExport) installed.

## Installation

```
pip install requests mysql-connector-python openpyxl
```

or

```
pip install -r requirements.txt
```

## Usage

There are 2 different ways that the script can fetch the data. If you use the database method, then you don't need to install the UserExport extension. If you use the UserExport extension, then you can ignore the database config and only set the wiki config.

```
python update_users_excel.py -h

usage: update_users_excel.py [-h] [--database-host 192.168.56.56]
                             [--database-port 3306]
                             [--database-database wiki_demo]
                             [--database-username wiki_app_user]
                             [--database-password password]
                             [--database-table-prefix]
                             [--database-user-table user]
                             [--wiki-uri https://192.168.56.56/demo]
                             [--wiki-api-path /api.php]
                             [--wiki-username Admin]
                             [--wiki-password adminpass]
                             [--config-type {database,wiki}]
                             [--users-excel-file-name Users.xlsx]
                             [--users-excel-file-path ./Users.xlsx]

Fetches the list of users from a database or wiki, creates an Excel workbook,
and then uploads the Excel file onto the wiki.

optional arguments:
  -h, --help            show this help message and exit
  --config-type {database,wiki}
                        Config type.
  --users-excel-file-name Users.xlsx
                        Users Excel file name.
  --users-excel-file-path ./Users.xlsx
                        Users Excel file path.

database:
  Database config.

  --database-host 192.168.56.56, --db-host 192.168.56.56
                        Database host.
  --database-port 3306, --db-port 3306
                        Database port.
  --database-database wiki_demo, --db-database wiki_demo, --db-db wiki_demo
                        Database database.
  --database-username wiki_app_user, --db-username wiki_app_user, --db-user wiki_app_user
                        Database username.
  --database-password password, --db-password password, --db-pass password
                        Database password.
  --database-table-prefix , --db-table-prefix
                        Database table prefix.
  --database-user-table user, --db-user-table user
                        Database user table.

wiki:
  Wiki config.

  --wiki-uri https://192.168.56.56/demo, --w-uri https://192.168.56.56/demo
                        Wiki URI.
  --wiki-api-path /api.php, --w-api-path /api.php
                        Wiki API path.
  --wiki-username Admin, --w-username Admin, --w-user Admin
                        Wiki username.
  --wiki-password adminpass, --w-password adminpass, --w-pass adminpass
                        Wiki password.
```

Default values can be modified by editing the `CONFIG` dictionary.